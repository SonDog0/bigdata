import re

def make_cool(str):
    str = re.sub(r'[\s]', '', str)
    str = re.sub(r'[,]','',str)
    str = re.sub(r'["]','',str)
    return str





lists = """

 "강남파라곤"| "241"| "170.570 "| "01.16"| "150,000 "| "14"| " "| " "| " "| " "| " "| " "|""|""| 
 " "| "241-1"| "117.840 "| " "| " "| " "| "02.06"| "127,000 "| "12"| "03.30"| "135,000 "| "10"|""|""| 
 " "| " "| "170.570 "| "01.29"| "149,000 "| "14"| " "| " "| " "| " "| " "| " "|" "|" "| 
 "거평프리젠"| "196"| "31.295 "| "01.28"| "21,500 "| "3"| " "| " "| " "| " "| " "| " "|""|""| 
 " "| " "| "31.585 "| " "| " "| " "| " "| " "| " "| "03.15"| "25,000 "| "2"|" "|" "| 
 " "| " "| "39.035 "| "01.31"| "33,300 "| "8"| " "| " "| " "| " "| " "| " "|" "|" "| 
 " "| " "| "42.015 "| "01.22"| "34,800 "| "11"| " "| " "| " "| " "| " "| " "|" "|" "| 
 "골든캐슬"| "103-11"| "123.800 "| "01.15"| "95,500 "| "4"| " "| " "| " "| " "| " "| " "|""|""| 
 "논현e-편한세상"| "195-1"| "129.184 "| " "| " "| " "| " "| " "| " "| "03.30"| "88,700 "| "1"|""|""| 
 "논현동한진로즈힐"| "105-4"| "84.940 "| "01.22"| "97,500 "| "4"| " "| " "| " "| " "| " "| " "|""|""| 
 "논현두산위브"| "258"| "84.253 "| " "| " "| " "| " "| " "| " "| "03.21"| "111,000 "| "5"|""|""| 
 "논현베르빌"| "214-2"| "111.080 "| "01.04"| "85,000 "| "7"| " "| " "| " "| " "| " "| " "|""|""| 
 " "| " "| "111.360 "| "01.1201.26"| "87,500 88,000 "| "75"| " "| " "| " "| "03.28"| "78,000 "| "1"|" "|" "| 
 " "| " "| "132.590 "| "01.1601.23"| "86,000 89,000 "| "37"| " "| " "| " "| " "| " "| " "|" "|" "| 
 "논현신동아"| "22"| "35.730 "| "01.0801.16"| "68,000 69,700 "| "118"| "02.03"| "71,500 "| "13"| "03.03"| "63,000 "| "1"|""|""| 
 " "| " "| "84.520 "| "01.15"| "110,000 "| "7"| "02.0602.13"| "105,000 117,000 "| "16"| "03.24"| "107,000 "| "3"|" "|" "| 
 " "| " "| "114.340 "| "01.2201.24"| "120,000 130,000 "| "107"| " "| " "| " "| "03.12"| "127,000 "| "6"|" "|" "| 
 "논현에이스빌라"| "123-9"| "193.620 "| " "| " "| " "| " "| " "| " "| "03.16"| "87,000 "| "2"|""|""| 
 "동부센트레빌"| "275"| "84.988 "| " "| " "| " "| " "| " "| " "| "03.08"| "123,000 "| "4"|""|""| 
 " "| " "| "91.593 "| " "| " "| " "| "02.22"| "132,000 "| "7"| " "| " "| " "|" "|" "| 
 " "| " "| "114.498 "| "01.0901.2201.2701.30"| "124,000 128,000 129,000 135,500 "| "510412"| "02.07"| "130,000 "| "3"| " "| " "| " "|" "|" "| 
 "동양파라곤"| "245"| "149.160 "| " "| " "| " "| " "| " "| " "| "03.23"| "220,000 "| "9"|""|""| 
 " "| " "| "149.830 "| "01.23"| "240,000 "| "14"| " "| " "| " "| " "| " "| " "|" "|" "| 
 " "| " "| "157.410 "| "01.29"| "190,000 "| "9"| "02.0702.2002.28"| "195,000 197,000 200,000 "| "31411"| "03.15"| "198,500 "| "7"|" "|" "| 
 " "| " "| "160.330 "| " "| " "| " "| "02.13"| "195,000 "| "12"| "03.08"| "195,000 "| "6"|" "|" "| 
 " "| " "| "180.070 "| " "| " "| " "| "02.26"| "230,000 "| "6"| "03.03"| "238,000 "| "7"|" "|" "| 
 " "| " "| "208.350 "| " "| " "| " "| "02.07"| "300,000 "| "4"| " "| " "| " "|" "|" "| 
 "동현"| "105"| "84.920 "| " "| " "| " "| " "| " "| " "| "03.10"| "135,000 "| "5"|""|""| 
 "두영"| "216-1"| "84.840 "| " "| " "| " "| "02.0202.02"| "64,200 63,700 "| "23"| " "| " "| " "|""|""| 
 "마일스디오빌"| "58-2"| "36.290 "| "01.2201.24"| "41,000 41,000 "| "156"| "02.19"| "39,000 "| "4"| "03.13"| "41,000 "| "14"|""|""| 
 "벨러스빌"| "47-11"| "160.970 "| " "| " "| " "| " "| " "| " "| "03.14"| "110,000 "| "3"|""|""| 
 "스위트케슬레지던스"| "55"| "143.280 "| " "| " "| " "| " "| " "| " "| "03.08"| "120,000 "| "1"|""|""| 
 " "| " "| "167.220 "| " "| " "| " "| "02.09"| "133,000 "| "3"| " "| " "| " "|" "|" "| 
 "쌍용"| "103"| "59.910 "| " "| " "| " "| "02.28"| "72,000 "| "5"| " "| " "| " "|""|""| 
 "아크로힐스논현"| "276-1"| "84.130 "| " "| " "| " "| "02.28"| "159,500 "| "26"| " "| " "| " "|""|""| 
 " "| " "| "84.208 "| "01.14"| "146,000 "| "26"| " "| " "| " "| " "| " "| " "|" "|" "| 
 " "| " "| "113.087 "| "01.1101.30"| "161,000 190,000 "| "2414"| " "| " "| " "| " "| " "| " "|" "|" "| 
 " "| " "| "113.231 "| "01.29"| "180,000 "| "16"| " "| " "| " "| "03.30"| "195,000 "| "2"|" "|" "| 
 "우민"| "107-44"| "74.758 "| " "| " "| " "| "02.24"| "80,300 "| "5"| " "| " "| " "|""|""| 
 "우성"| "180-6"| "110.100 "| " "| " "| " "| " "| " "| " "| "03.25"| "74,000 "| "5"|""|""| 
 "웰스톤"| "108"| "80.850 "| "01.04"| "69,500 "| "7"| " "| " "| " "| " "| " "| " "|""|""| 
 " "| " "| "83.640 "| " "| " "| " "| " "| " "| " "| "03.01"| "83,000 "| "4"|" "|" "| 
 "이움빌라"| "229-13"| "122.810 "| "01.27"| "87,000 "| "4"| " "| " "| " "| " "| " "| " "|""|""| 
 " "| " "| "129.800 "| "01.26"| "90,000 "| "2"| " "| " "| " "| " "| " "| " "|" "|" "| 
 "청학아파트"| "62-3"| "97.180 "| "01.30"| "120,000 "| "4"| " "| " "| " "| " "| " "| " "|""|""| 
 "케럿스테이트"| "267-18"| "131.010 "| " "| " "| " "| "02.12"| "93,500 "| "1"| " "| " "| " "|""|""| 
 "프라임"| "80-13"| "77.990 "| "01.17"| "68,000 "| "7"| " "| " "| " "| " "| " "| " "|""|""| 
 " "| "192-3"| "134.280 "| " "| " "| " "| "02.09"| "84,500 "| "2"| " "| " "| " "|""|""| 
 " "| " "| "135.300 "| " "| " "| " "| " "| " "| " "| "03.01"| "87,500 "| "6"|" "|" "| 
 " "| "196-4"| "122.440 "| "01.17"| "78,000 "| "3"| " "| " "| " "| " "| " "| " "|""|""| 
 "한화꿈에그린"| "205-2"| "67.671 "| "01.10"| "80,000 "| "2"| " "| " "| " "| " "| " "| " "|""|""| 
 "한화꿈에그린2차"| "194-23"| "104.190 "| " "| " "| " "| " "| " "| " "| "03.07"| "98,000 "| "10"|""|""| 
 " "| " "| "117.335 "| "01.18"| "87,000 "| "5"| " "| " "| " "| " "| " "| " "|" "|" "| 
 "현대넥서스"| "261-8"| "244.610 "| " "| " "| " "| " "| " "| " "| "03.07"| "135,000 "| "1"|""|""| 
 ""| 
"""
# |  구분자로 각 항목 분리
realprices = lists.split('|')

# print(realpirces[0],realpirces[1],realpirces[2],realpirces[3],realpirces[4],realpirces[5],realpirces[6],realpirces[7],realpirces[8],realpirces[9],realpirces[10],realpirces[11],realpirces[12],realpirces[13])


#
# for i in range(0, len(realpirces)):
#     print(realpirces[i])
#

# 실거래가 정보 JSON형식으로 작성

# {'단지' : '강남파라곤' , '지번' : '241' , '전용면적' : 170.570 , '실거래가' : [{ '계약일' : '2018-01-16' , '거래금액' : '150,000' , '층' : '14'} ]}
#
# {'단지' : '강남파라곤' , '지번' : '241-1' , '전용면적' : 117.840 , '실거래가' : [{ '계약일' : '2018-06-06' , '거래금액' : '127,000' , '층' : '12'} ,{ '계약일' : '2018-03-30' , '거래금액' : '135,000' , '층' : '10'} ]}
#
# {'단지' : '강남파라곤' , '지번' : '241-1' , '전용면적' : 117.840 , '실거래가' : [{ '계약일' : '2018-01-29' , '거래금액' : '149,000' , '층' : '12'}  ]}

# python으로 실거래가 JSON 객체 생성

# apt = {}
# rps = []
#
# apt['단지'] = '강남파라곤'
# apt['지번'] = '241'
# apt['전용면적'] = '170.571'
# # apt json형식에 3가지 넣고
#
# # 네번째는 배열형식이므로 다시 json정의하고(rp) 그 json을 원래json(apt)에 append
# rp = {}
# rp['계약일'] = '2018-01-16'
# rp['거래금액'] = '150,000'
# rp['층'] = '14'
#
# rps.append(rp)
#
# # 네번째 실거래가에 만들어놓은 rps 넣기
# apt['실거래가'] = rps
#
# print(apt)


# 공백, 콤마 제거 - 함수 이용
# print(realprices[2], realprices[4])
# print(re.sub(r'[\s]','' ,realprices[2]),
#       re.sub(r'[,]','',realprices[4]),
#       re.sub(r'"','',realprices[4]) )


# print(make_cool(realprices[2]), make_cool(realprices[4]))

# 행별로 모아서 출력
# print(len(realprices))
# for i in range(0,int(len(realprices) / 14 )):
#     for j in range(0,14):
#         print(i +1 , '[' , make_cool(realprices[i*14+j])   , ']' )



# 반복문을 이용해서 '실거래가' JSON객체 생성


# for i in range(0, int(len(realprices)/14)):
#     apt = {}  # 단지 , 지번 , 면적
#     rps = []  # 실거래가 ( 계약일, 거래금액, 층 )
#
#     # 단지 지번 면적
#     apt['단지'] = make_cool(realprices[ i * 14 + 0])
#     apt['지번'] = make_cool(realprices[i * 14 + 1])
#     apt['면적'] = make_cool(realprices[i * 14 + 2])
#
#     # 실거래가 #1
#     rp = {}
#     rp['계약일'] = make_cool(realprices[ i * 14 + 3])
#     rp['거래금액'] = make_cool(realprices[i * 14 + 4])
#     rp['층'] = make_cool(realprices[i * 14 + 5])
#
#     rps.append(rp)
#
#     rp = {}
#     rp['계약일'] = make_cool(realprices[i * 14 + 6])
#     rp['거래금액'] = make_cool(realprices[i * 14 + 7])
#     rp['층'] = make_cool(realprices[i * 14 + 8])
#
#     rps.append(rp)
#
#     rp = {}
#     rp['계약일'] = make_cool(realprices[i * 14 + 9])
#     rp['거래금액'] = make_cool(realprices[i * 14 + 10])
#     rp['층'] = make_cool(realprices[i * 14 + 11])
#
#     rps.append(rp)
#
#     #생성된 실거래가 데이터를 추가
#     apt['실거래가'] = rps
#
#     print(apt)



# 반복문으로 처리시 코드를 줄여 쓰기 위해
# json 객체의 key를 배열로 정의

keys = ['단지' , '지번', '전용면적', '실거래가', '계약일', '거래금액', '층']

for i in range(0, int(len(realprices)/14)):
    apt = {}
    rps = []

    for j in range(0,3):
        apt[keys[j]] = make_cool((realprices[i * 14 + j  ]))


    for j in range(4,7):
        rp = {}
        rp[keys[j]] = make_cool((realprices[i * 14 + j - 1 ]))
        rps.append(rp)




    # 실거래가 #2
    for j in range(4,7):
        rp = {}
        rp[keys[j]] = make_cool((realprices[i * 14 + j - 1 + 3 ]))
        rps.append(rp)

    # 실거래가 #3
    for j in range(4,7):
        rp = {}
        rp[keys[j]] = make_cool((realprices[i * 14 + j - 1 + 6 ]))
        rps.append(rp)



        apt[keys[3]] = rps
        print(apt)




